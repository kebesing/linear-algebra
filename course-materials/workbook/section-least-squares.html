<!DOCTYPE html>
<!--**************************************-->
<!--* Generated from MathBook XML source *-->
<!--*    on 2015-11-03T17:12:41-06:00    *-->
<!--*                                    *-->
<!--*   http://mathbook.pugetsound.edu   *-->
<!--*                                    *-->
<!--**************************************-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Approximate Solutions: Least Squares</title>
<meta name="Keywords" content="Authored in MathBook XML">
<meta name="viewport" content="width=device-width,  initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['\\(','\\)']]
    },
    TeX: {
        extensions: ["AMSmath.js", "AMSsymbols.js", "extpfeil.js", "autobold.js"],
        equationNumbers: { autoNumber: "none",
                           useLabelIds: true,
                           formatID: function (n) {return String(n).replace(/[:'"<>&]/g,"")},
                         },
        TagSide: "right",
        TagIndent: ".8em",
    },
    "HTML-CSS": {
        scale: 88,
    },
});
    </script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML-full"></script><script type="text/javascript" src="http://sagecell.sagemath.org/static/jquery.min.js"></script><script type="text/javascript" src="http://sagecell.sagemath.org/embedded_sagecell.js"></script><script>
$(function () {
    // Make *any* div with class 'sage-compute' an executable Sage cell
    sagecell.makeSagecell({inputLocation: 'div.sage-compute',
                           linked: true,
                           evalButtonText: 'Evaluate'});
});
$(function () {
    // Make *any* div with class 'sage-display' a visible, uneditable Sage cell
    sagecell.makeSagecell({inputLocation: 'div.sage-display',
                           editor: 'codemirror-readonly',
                           hide: ['evalButton', 'editorToggle', 'language']});
});
    </script><script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script><link href="http://aimath.org/knowlstyle.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="http://aimath.org/knowl.js"></script><script src="http://aimath.org/mathbook/js/lib/jquery.sticky.js"></script><script src="http://aimath.org/mathbook/js/lib/jquery.espy.min.js"></script><script src="http://aimath.org/mathbook/js/Mathbook.js"></script><link href="http://fonts.googleapis.com/css?family=Open+Sans:400,400italic,600,600italic%7CSource+Code+Pro:400" rel="stylesheet" type="text/css">
<link href="http://aimath.org/mathbook/stylesheets/mathbook-3.css" rel="stylesheet" type="text/css">
<link href="http://aimath.org/mathbook/mathbook-add-on.css" rel="stylesheet" type="text/css">
</head>
<body class="mathbook-book has-toc has-sidebar-left">
<div style="display:none;">\(
    
    \newcommand{\augmatrix}[2]{\left(\begin{array}{@{}#1 |c@{}} #2 \end{array}\right)}
  \)</div>
<header id="masthead"><div class="banner"><div class="container">
<a id="logo-link" href=""></a><div class="title-container">
<h1 class="heading"><span class="title">Math 2500: Linear Algebra</span></h1>
<p class="byline"></p>
</div>
</div></div>
<nav id="primary-navbar"><div class="container">
<div class="navbar-top-buttons">
<button class="sidebar-left-toggle-button button active">Contents</button><div class="tree-nav toolbar toolbar-divisor-3">
<a class="previous-button toolbar-item button" href="section-gf-proj.html">Previous</a><a class="up-button button toolbar-item" href="chapter-orthogonality.html">Up</a><a class="next-button button toolbar-item" href="section-gram-schmidt.html">Next</a>
</div>
<button class="sidebar-right-toggle-button button active">Annotations</button>
</div>
<div class="navbar-bottom-buttons toolbar toolbar-divisor-4">
<button class="sidebar-left-toggle-button button toolbar-item active">Contents</button><a class="previous-button toolbar-item button" href="section-gf-proj.html">Previous</a><a class="up-button button toolbar-item" href="chapter-orthogonality.html">Up</a><a class="next-button button toolbar-item" href="section-gram-schmidt.html">Next</a>
</div>
</div></nav></header><div class="page">
<aside id="sidebar-left" class="sidebar"><div class="sidebar-content">
<nav id="toc"><h2 class="link"><a href="index.html"><span class="title">Front Matter</span></a></h2>
<ul>
<li><a href="preface-1.html">Preface</a></li>
<li><a href="acknowledgement-1.html">Acknowledgements</a></li>
</ul>
<h2 class="link"><a href="chapter-basic-objects.html"><span class="codenumber">1</span><span class="title">Vectors, the Dot Product, and Matrices</span></a></h2>
<ul>
<li><a href="vectors.html">Vectors</a></li>
<li><a href="dot-product.html">The Dot Product</a></li>
<li><a href="matrices.html">Matrices</a></li>
<li><a href="start-sage.html">Getting Started with Sage</a></li>
<li><a href="basic-objects-going-further.html">Going Further with the Basic Objects</a></li>
</ul>
<h2 class="link"><a href="chapter-2.html"><span class="codenumber">2</span><span class="title">Linear Equations</span></a></h2>
<ul>
<li><a href="three-pictures.html">Three Geometric Models</a></li>
<li><a href="elimination.html">Solving Systems</a></li>
<li><a href="matrix-elimination.html">Elimination using Matrices</a></li>
<li><a href="lin-eq-going-further-1.html">Going Further with Elimination</a></li>
<li><a href="matrix-algebra.html">Matrix Algebra</a></li>
<li><a href="inverse.html">Matrix Inverses</a></li>
<li><a href="lu-decomposition.html">The \(LU\) Decomposition</a></li>
<li><a href="permutations.html">Permutation Matrices</a></li>
<li><a href="lin-eq-gf2.html">Matrix Algebra: Going Further</a></li>
</ul>
<h2 class="link"><a href="chapter-subspaces.html"><span class="codenumber">3</span><span class="title">Vector Spaces and Subspaces</span></a></h2>
<ul>
<li><a href="vector-spaces.html">Subspaces of \(\mathbb{R}^n\)</a></li>
<li><a href="nullspace.html">The Nullspace</a></li>
<li><a href="rank.html">Rank and the RREF</a></li>
<li><a href="complete-solution.html">Solving a System</a></li>
<li><a href="soln-gf.html">Going Further with Solving Systems</a></li>
<li><a href="basis.html">Bases</a></li>
<li><a href="four-subspaces.html">The Four Subspaces</a></li>
<li><a href="ftla-gf.xml.html">Going Further with the Fundamental Theorem</a></li>
</ul>
<h2 class="link active"><a href="chapter-orthogonality.html"><span class="codenumber">4</span><span class="title">Orthogonality</span></a></h2>
<ul>
<li><a href="section-ftla2.html">Orthogonality and the Four Subspaces</a></li>
<li><a href="section-projections.html">Projections Onto Subspaces</a></li>
<li><a href="section-gf-proj.html">Going Further: Projections</a></li>
<li><a href="section-least-squares.html" class="active">Approximate Solutions: Least Squares</a></li>
<li><a href="section-gram-schmidt.html">Orthonormal Bases and Gram-Schmidt</a></li>
<li><a href="section-gf-ls-gs.html">Going Further: Least Squares and Gram-Schmidt</a></li>
</ul>
<h2 class="link"><a href="chapter-determinants.html"><span class="codenumber">5</span><span class="title">Determinants</span></a></h2>
<ul>
<li><a href="section-det-properties.html">Properties of the Determinant</a></li>
<li><a href="section-det-computation.html">Computing Determinants</a></li>
<li><a href="section-det-gf.html">Going Further: The Determinant</a></li>
</ul>
<h2 class="link"><a href="chapter-eigendata-and-svd.html"><span class="codenumber">6</span><span class="title">Eigendata and the Singular Value decomposition</span></a></h2>
<ul>
<li><a href="section-eigenvectors.html">Eigenvectors and Eigenvalues</a></li>
<li><a href="section-diagonalization.html">Diagonalizing Matrices</a></li>
<li><a href="section-spectral-theorem.html">The Spectral Theorem</a></li>
<li><a href="section-gf-eigendata.html">Going Further with Eigendata</a></li>
<li><a href="section-svd.html">Singular Value Decomposition</a></li>
<li><a href="section-gf-svd.html">Going Further with the SVD</a></li>
</ul></nav><div class="extras"><nav><a class="feedback-link" href="https://docs.google.com/forms/d/1ru8ipyTKm2QsWRYILXilnle9dC7rr6j8a22hLdvCGKU/viewform?usp=send_form">Leave Feedback</a><a class="mathbook-link" href="http://mathbook.pugetsound.edu">Authored in MathBookÂ XML</a><a href="http://www.mathjax.org"><img title="Powered by MathJax" src="http://cdn.mathjax.org/mathjax/badge/badge.gif" border="0" alt="Powered by MathJax"></a></nav></div>
</div></aside><main class="main"><div id="content" class="mathbook-content"><section class="section" id="section-least-squares"><header><h1 class="heading" alt="Section 4.4 Approximate Solutions: Least Squares" title="Section 4.4 Approximate Solutions: Least Squares">
<span class="type">Section</span><span class="codenumber">4.4</span><span class="title">Approximate Solutions: Least Squares</span>
</h1></header><section class="subsection" id="subsection-104"><header><h1 class="heading hide-type">
<span class="type">Subsection</span><span class="codenumber"></span><span class="title">The Assignment</span>
</h1></header><ul style="list-style-type: disc;">
<li>Read section 4.3 of Strang.</li>
<li>Read the discussion below.</li>
<li>Complete exercises 1-11 from section 4.3 in Strang.</li>
<li>Prepare the items in the exercises for presentation.</li>
</ul></section><section class="subsection" id="subsection-105"><header><h1 class="heading hide-type">
<span class="type">Subsection</span><span class="codenumber"></span><span class="title">Discussion: Least Squares Approximation</span>
</h1></header><p>
      (It is probably best to read this after you read the section in Strang.)
    </p>
<section class="subsubsection" id="subsubsection-44"><header><h1 class="heading hide-type">
<span class="type">Subsubsection</span><span class="codenumber"></span><span class="title">Some Perspective</span>
</h1></header><p>
        Scientific problems often come down to something as simple as this: make
        a bunch of observations, and then try to fit those observations with
        some sort of model for greater understanding.
      </p>
<p>
        But data found in scientific problems is often noisy, or infected with
        error in some way. This leads researchers to gather <!--Style me with CSS--><em>more</em> data
        so that chance variations and small errors might get smoothed out.  How
        might we fit a curve to a lot of data? Lots of data points means that we
        likely have too many points to have a curve of our specified model type
        actually hit all of those points.
      </p>
<p>
        For example, fitting a line to five points is already problematic: any
        two points gives us a line, and there is no reason to believe that the
        other three points will all sit on that line.
      </p>
<p>
        If we set the problem up as a system of equations, things go like this:
        We have a bunch of data set up as input-output pairs \(\{ (a_i, y_i) \}\);
        we are looking for a function \(f\) which has a specified type (linear,
        quadratic, exponential, etc.) that passes through those points.
      </p>
<ul style="list-style-type: disc;">
<li>Each data point leads us to an equation \(f(a_i) = y_i\).</li>
<li>
          The modelling function $f$ has some parameters in it, and we want to
          find the best value of those parameters so that the curve âfitsâ
          the data well. These parameters are the unknowns in our equations.
        </li>
</ul>
<p>
        This is generally a challenging problem. The method of least squares is
        a technique for solving it when the resulting equations make a linear
        system.
      </p></section><section class="subsubsection" id="subsubsection-45"><header><h1 class="heading hide-type">
<span class="type">Subsubsection</span><span class="codenumber"></span><span class="title">Some History</span>
</h1></header><p>
        Gauss discovered the technique described in this section in the late
        1790's. In 1801 he used it to help astronomers calculate the orbit of
        the newly discovered asteroid Ceres, and thus find it after it re-emerged
        from behind the sun.
      </p>
<p>
        See how the pattern fits? Several weeks worth of data about the position
        of Ceres was known, but it surely had measurement errors in it. Since
        the time of Kepler (Newton), we have known that the motion of the
        asteroid must be an ellipse. This is a simple equation with only a few
        parameters (the coefficients of the equation defining the ellipse). So,
        the question confronting Gauss was this: find the ellipse which best
        fits the data.
      </p>
<p>
        But plugging all the data into the correct model shape (a conic!) leads
        to a rather large system of linear equations where the unknowns are the
        coefficients we seek.
      </p></section><section class="subsubsection" id="subsubsection-46"><header><h1 class="heading hide-type">
<span class="type">Subsubsection</span><span class="codenumber"></span><span class="title">So, what is really happening here?</span>
</h1></header><p>
        In the end, we get a system of the form \(Ax = y\). Here \(A\) is
        an \(m\times n\) matrix and \(ym\) is an \(n\)-vector, where
        \(m\) is the number of equations and \(n\) is the number of
        parameters we must find.
        Typically, \(m\) is much larger than \(n\), so the matrix \(A\)
        is tall and skinny.
      </p>
<p>
        So the system likely has no solution. Instead, we will find the orthogonal
        projection \(\hat{y}\) of \(y\) onto the column space
        \(\mathrm{col}(A)\) of \(A\), and then solve \(Ax = \hat{y}\).
        That's the secret. Since we have already mastered projections, this is
        no big deal.
      </p></section></section><section class="subsection" id="subsection-106"><header><h1 class="heading hide-type">
<span class="type">Subsection</span><span class="codenumber"></span><span class="title">Sage instructions</span>
</h1></header><p>
      There are no new commands for dealing with matrices here, as we already
      have all that we need. If you are interested, Sage does have a built-in
      function called <tt class="code-inline" style="color: red; font-size: 120%">find_fit</tt>.
    </p>
<div class="sage-compute"><script type="text/x-sage">Data = [[1,2], [-1,3], [4,1],[2,1],[1,.5]]
a, b, x = var('a b x')
model(x) = a*x + b

best = find_fit(Data, model, solution_dict=True)
best
</script></div>
<p>Just to check that, let's plot the data and the curve.</p>
<div class="sage-compute"><script type="text/x-sage">curve = model.subs(best)
plot(curve, (x,-1,6)) + points(Data, color='red', size=20)
</script></div>
<p>
      That is not so terrible. Keep in mind that, from a linear algebra perspective,
      we just found the projection of \(y = (2,3,1,1,.5) \in \mathbb{R}^5\) on
      the column space of the matrix
      <article class="displaymath" id="me-127">\[
        A = \begin{pmatrix} 1 &amp; 1 \\ -1 &amp; 1\\ 4 &amp; 1 \\ 2 &amp; 1 \\
        1 &amp; 1 \end{pmatrix},
      \]</article>
      which is a \(2\)-dimensional plane in that \(5\)-dimensional space.
      If I could, I would draw that picture, but five dimensions in challenging.
    </p></section><section class="subsection" id="subsection-107"><header><h1 class="heading hide-type">
<span class="type">Subsection</span><span class="codenumber"></span><span class="title">Exercises</span>
</h1></header><p>
      The best thing you can do to understand this is work some examples. Do
      Strang 1 - 11 from section 4.3. We will present these:
    </p>
<article class="example-like" id="task-131"><h5 class="heading">
<span class="type">Task</span><span class="codenumber">131</span><span class="title"></span>
</h5>
        Exercise 1 from section 4.3 of Strang.
      </article><article class="example-like" id="task-132"><h5 class="heading">
<span class="type">Task</span><span class="codenumber">132</span><span class="title"></span>
</h5>
        Exercise 5 from section 4.3 of Strang.
      </article><article class="example-like" id="task-133"><h5 class="heading">
<span class="type">Task</span><span class="codenumber">133</span><span class="title"></span>
</h5>
        Exercise 6 from section 4.3 of Strang.
      </article><article class="example-like" id="task-134"><h5 class="heading">
<span class="type">Task</span><span class="codenumber">134</span><span class="title"></span>
</h5>
        Exercise 7 from section 4.3 of Strang.
      </article><article class="example-like" id="task-135"><h5 class="heading">
<span class="type">Task</span><span class="codenumber">135</span><span class="title"></span>
</h5>
        Exercise 8 from section 4.3 of Strang.
      </article><article class="example-like" id="task-136"><h5 class="heading">
<span class="type">Task</span><span class="codenumber">136</span><span class="title"></span>
</h5>
        Exercise 9 from section 4.3 of Strang.
      </article><article class="example-like" id="task-137"><h5 class="heading">
<span class="type">Task</span><span class="codenumber">137</span><span class="title"></span>
</h5>
        Exercise 10 from section 4.3 of Strang.
      </article><article class="example-like" id="task-138"><h5 class="heading">
<span class="type">Task</span><span class="codenumber">138</span><span class="title"></span>
</h5>
        Exercise 11 from section 4.3 of Strang.
      </article></section></section></div></main>
</div>
</body>
</html>
